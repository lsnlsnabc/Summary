<html>
<head>
  <title>linux下grep、find、sed、awk使用</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/305825 (zh-CN, DDL); Windows/10.0.14393 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="514"/>
<h1>linux下grep、find、sed、awk使用</h1>

<div>
<span><div>首先若需要对某个命令进行了解，使用 命令符 --help可进行具体查询</div><div><br/></div><div><i>grep</i></div><div><hr/></div><div>grep命令是一种强大的文本搜索工具，它能使用正则表达式搜索文本并把匹配的行打印出来</div><div><br/></div><div><i>find</i></div><div><hr/></div><div>最常用法： find [路径] -name “正则表达式”</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[root@MiWiFi-R1CM-srv home]# find . -name &quot;ls*&quot;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">./lsn.txt</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">./lsn</span></div></div><div><br/></div><div><i>awk</i></div><div><hr/></div><div>awk是一个强大的文本分析工具</div><div><b>简单提取某列信息，默认列与列之间以空格作为分割符</b></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[root@MiWiFi-R1CM-srv home]# last -n 5</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">root     pts/0        192.168.31.196   Sat Mar  4 13:53   still logged in   </span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">root     pts/1        192.168.31.196   Sat Mar  4 09:34 - 13:53  (04:18)    </span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">root     pts/0        192.168.31.196   Sat Mar  4 06:31 - 11:33  (05:01)    </span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">root     pts/0        192.168.31.196   Thu Mar  2 13:16 - 20:10 (1+06:53)   </span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">root     tty1                          Thu Mar  2 13:11   still logged in   </span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">wtmp begins Fri Feb 24 01:20:42 2017</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[root@MiWiFi-R1CM-srv home]# last -n 5 | awk '{print $1}'</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">root</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">root</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">root</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">root</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">root</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">wtmp</span></div></div><div><b>-F 可选择分隔符</b></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[root@MiWiFi-R1CM-srv home]# cat /etc/passwd | awk -F ':' '{print $1}'</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">root</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">bin</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">daemon</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">adm</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">lp</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">sync</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">shutdown</span></div></div><div><b>awk的工作流程</b>为：先执行BEGIN，然后读取文件，读入有/n换行符分割的一条记录，然后将记录按指定的域分隔符划分，$0表示所有域，$1表示第一个域，以此类推</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[root@MiWiFi-R1CM-srv home]# cat /etc/passwd |awk -F ':' 'BEGIN {print &quot;name,shell&quot;} {print $1&quot;,&quot;$7} END{print &quot;blue,/bin/nosh&quot;}'</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">name,shell</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">root,/bin/bash</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">bin,/sbin/nologin</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">daemon,/sbin/nologin</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">adm,/sbin/nologin</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">lp,/sbin/nologin</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">sync,/bin/sync</span></div></div><div><b>awk内置变量</b></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;-en-codeblock:true;"><div style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"><span style="line-height: 1.5 !important; font-family: &quot;Courier New&quot; !important; font-size: 12px !important; color: rgb(0, 0, 0);">ARGC    命令行参数个数</span></div><div style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"><span style="line-height: 1.5 !important; font-family: &quot;Courier New&quot; !important; font-size: 12px !important; color: rgb(0, 0, 0);">ARGV    命令行参数排列</span></div><div style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"><span style="line-height: 1.5 !important; font-family: &quot;Courier New&quot; !important; font-size: 12px !important; color: rgb(0, 0, 0);">ENVIRON    支持队列中系统环境变量的使用</span></div><div style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"><span style="line-height: 1.5 !important; font-family: &quot;Courier New&quot; !important; font-size: 12px !important; color: rgb(0, 0, 0);">FILENAME    awk浏览的文件名</span></div><div style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"><span style="line-height: 1.5 !important; font-family: &quot;Courier New&quot; !important; font-size: 12px !important; color: rgb(0, 0, 0);">FNR    浏览文件的记录数</span></div><div style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"><span style="line-height: 1.5 !important; font-family: &quot;Courier New&quot; !important; font-size: 12px !important; color: rgb(0, 0, 0);">FS    设置输入域分隔符，等价于命令行</span> <span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">-</span><span style="line-height: 1.5 !important; font-family: &quot;Courier New&quot; !important; font-size: 12px !important; color: rgb(0, 0, 0);">F选项</span></div><div style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"><span style="line-height: 1.5 !important; font-family: &quot;Courier New&quot; !important; font-size: 12px !important; color: rgb(0, 0, 0);">NF    浏览记录的域的个数</span></div><div style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"><span style="line-height: 1.5 !important; font-family: &quot;Courier New&quot; !important; font-size: 12px !important; color: rgb(0, 0, 0);">NR    已读的记录数</span></div><div style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"><span style="line-height: 1.5 !important; font-family: &quot;Courier New&quot; !important; font-size: 12px !important; color: rgb(0, 0, 0);">OFS    输出域分隔符</span></div><div style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"><span style="line-height: 1.5 !important; font-family: &quot;Courier New&quot; !important; font-size: 12px !important; color: rgb(0, 0, 0);">ORS    输出记录分隔符</span></div><div style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"><span style="line-height: 1.5 !important; font-family: &quot;Courier New&quot; !important; font-size: 12px !important; color: rgb(0, 0, 0);">RS    控制记录分隔符</span></div></div><div><b>awk提供两种打印输出的函数</b>：print和printf</div><div>print的参数可以是变量、数值或字符串。字符串必须用双引号引用，参数用逗号分隔</div><div>printf用法和c语言中的基本相似，可以格式化字符串，输出复杂时更好用，代码更易懂</div><div><b>awk编程</b></div><div>awk可以自定义变量</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;-en-codeblock:true;"><div><span style="white-space: pre-wrap; word-wrap: break-word; font-family: &quot;Courier New&quot; !important; font-size: 12px !important; color: rgb(0, 0, 255); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 1.5 !important;">awk</span> <span style="white-space: pre-wrap; word-wrap: break-word; font-family: &quot;Courier New&quot; !important; font-size: 12px !important; color: rgb(128, 0, 0); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 1.5 !important;">'</span><span style="white-space: pre-wrap; word-wrap: break-word; font-family: &quot;Courier New&quot; !important; font-size: 12px !important; color: rgb(128, 0, 0); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 1.5 !important;">{count++;print $0;} END{print &quot;user count is &quot;, count}</span><span style="white-space: pre-wrap; word-wrap: break-word; font-family: &quot;Courier New&quot; !important; font-size: 12px !important; color: rgb(128, 0, 0); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 1.5 !important;">'</span> <span style="white-space: pre-wrap; word-wrap: break-word; font-family: &quot;Courier New&quot; !important; font-size: 12px; color: rgb(0, 0, 0); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">/etc/</span><span style="white-space: pre-wrap; word-wrap: break-word; font-family: &quot;Courier New&quot; !important; font-size: 12px !important; color: rgb(0, 0, 255); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; line-height: 1.5 !important;">passwd</span></div></div><div><br/></div></span>
</div></body></html> 