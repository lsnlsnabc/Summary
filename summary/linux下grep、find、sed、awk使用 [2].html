<html>
<head>
  <title>linux下grep、find、sed、awk使用</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/305825 (zh-CN, DDL); Windows/10.0.14393 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="561"/>
<h1>linux下grep、find、sed、awk使用</h1>

<div>
<span><div><div>首先若需要对某个命令进行了解，使用 命令符 --help可进行具体查询</div><div><br/></div><div><span style="font-style: italic;">grep</span></div><div><hr/></div><div>grep命令是一种强大的文本搜索工具，它能使用正则表达式搜索文本并把匹配的行打印出来</div><div><br/></div><div><span style="font-style: italic;">find</span></div><div><hr/></div><div>最常用法： find [路径] -name “正则表达式”</div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">[root@MiWiFi-R1CM-srv home]# find . -name &quot;ls*&quot;</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">./lsn.txt</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">./lsn</span></div></div><div><br/></div><div><span style="font-style: italic;">awk</span></div><div><hr/></div><div>awk是一个强大的文本分析工具</div><div><ul><li><span style="font-family: 宋体; line-height: 1.45;">简单提取某列信息，默认列与列之间以空格作为分割符</span></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">[root@MiWiFi-R1CM-srv home]# last -n 5</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">root     pts/0        192.168.31.196   Sat Mar  4 13:53   still logged in   </span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">root     pts/1        192.168.31.196   Sat Mar  4 09:34 - 13:53  (04:18)    </span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">root     pts/0        192.168.31.196   Sat Mar  4 06:31 - 11:33  (05:01)    </span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">root     pts/0        192.168.31.196   Thu Mar  2 13:16 - 20:10 (1+06:53)   </span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">root     tty1                          Thu Mar  2 13:11   still logged in   </span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">wtmp begins Fri Feb 24 01:20:42 2017</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">[root@MiWiFi-R1CM-srv home]# last -n 5 | awk '{print $1}'</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">root</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">root</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">root</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">root</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">root</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">wtmp</span></div></div><div><ul><li><span style="font-family: 宋体; line-height: 1.45;">-F 可选择分隔符</span><br/></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">[root@MiWiFi-R1CM-srv home]# cat /etc/passwd | awk -F ':' '{print $1}'</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">root</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">bin</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">daemon</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">adm</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">lp</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">sync</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">shutdown</span></div></div><div><ul><li><font style="line-height: 1.45; font-family: 宋体;">awk的工作流程</font><span style="line-height: 1.45;">为：先执行BEGIN，然后读取文件，读入有/n换行符分割的一条记录，然后将记录按指定的域分隔符划分，$0表示所有域，$1表示第一个域，以此类推</span><br/></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">[root@MiWiFi-R1CM-srv home]# cat /etc/passwd |awk -F ':' 'BEGIN {print &quot;name,shell&quot;} {print $1&quot;,&quot;$7} END{print &quot;blue,/bin/nosh&quot;}'</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">name,shell</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">root,/bin/bash</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">bin,/sbin/nologin</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">daemon,/sbin/nologin</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">adm,/sbin/nologin</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">lp,/sbin/nologin</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">sync,/bin/sync</span></div></div><div><ul><li><span style="font-family: 宋体; line-height: 1.45;">awk内置变量</span><br/></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div style="font-size: 9pt;"><span style="font-size: 12px !important; background-color: rgb(251, 250, 248); color: rgb(0, 0, 0); font-family: 'Courier New'; line-height: 1.5;">ARGC    命令行参数个数</span></div><div style="font-size: 9pt;"><span style="font-size: 12px !important; background-color: rgb(251, 250, 248); color: rgb(0, 0, 0); font-family: 'Courier New'; line-height: 1.5;">ARGV    命令行参数排列</span></div><div style="font-size: 9pt;"><span style="font-size: 12px !important; background-color: rgb(251, 250, 248); color: rgb(0, 0, 0); font-family: 'Courier New'; line-height: 1.5;">ENVIRON    支持队列中系统环境变量的使用</span></div><div style="font-size: 9pt;"><span style="font-size: 12px !important; background-color: rgb(251, 250, 248); color: rgb(0, 0, 0); font-family: 'Courier New'; line-height: 1.5;">FILENAME    awk浏览的文件名</span></div><div style="font-size: 9pt;"><span style="font-size: 12px !important; background-color: rgb(251, 250, 248); color: rgb(0, 0, 0); font-family: 'Courier New'; line-height: 1.5;">FNR    浏览文件的记录数</span></div><div style="font-size: 9pt;"><span style="font-size: 12px !important; background-color: rgb(251, 250, 248); color: rgb(0, 0, 0); font-family: 'Courier New'; line-height: 1.5;">FS    设置输入域分隔符，等价于命令行</span> <span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">-</span><span style="font-size: 12px !important; background-color: rgb(251, 250, 248); color: rgb(0, 0, 0); font-family: 'Courier New'; line-height: 1.5;">F选项</span></div><div style="font-size: 9pt;"><span style="font-size: 12px !important; background-color: rgb(251, 250, 248); color: rgb(0, 0, 0); font-family: 'Courier New'; line-height: 1.5;">NF    浏览记录的域的个数</span></div><div style="font-size: 9pt;"><span style="font-size: 12px !important; background-color: rgb(251, 250, 248); color: rgb(0, 0, 0); font-family: 'Courier New'; line-height: 1.5;">NR    已读的记录数</span></div><div style="font-size: 9pt;"><span style="font-size: 12px !important; background-color: rgb(251, 250, 248); color: rgb(0, 0, 0); font-family: 'Courier New'; line-height: 1.5;">OFS    输出域分隔符</span></div><div style="font-size: 9pt;"><span style="font-size: 12px !important; background-color: rgb(251, 250, 248); color: rgb(0, 0, 0); font-family: 'Courier New'; line-height: 1.5;">ORS    输出记录分隔符</span></div><div style="font-size: 9pt;"><span style="font-size: 12px !important; background-color: rgb(251, 250, 248); color: rgb(0, 0, 0); font-family: 'Courier New'; line-height: 1.5;">RS    控制记录分隔符</span></div></div><div><ul><li><font style="line-height: 1.45; font-family: 宋体;">awk提供两种打印输出的函数</font><span style="line-height: 1.45;">：print和printf</span><br/></li></ul></div><div><font face="宋体">print的参数可以是变量、数值或字符串。字符串必须用双引号引用，参数用逗号分隔</font></div><div><font face="宋体">printf用法和c语言中的基本相似，可以格式化字符串，输出复杂时更好用，代码更易懂</font></div><div><ul><li><span style="font-family: 宋体; line-height: 1.45;">awk编程</span><br/></li></ul></div><div><font style="font-family: 宋体;">awk可以自定义变量</font></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="white-space: pre-wrap; word-wrap: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 12px !important; background-color: rgb(251, 250, 248); color: rgb(0, 0, 255); font-family: 'Courier New'; line-height: 1.5;">awk</span> <span style="white-space: pre-wrap; word-wrap: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 12px !important; background-color: rgb(251, 250, 248); color: rgb(128, 0, 0); font-family: 'Courier New'; line-height: 1.5;">'</span><span style="white-space: pre-wrap; word-wrap: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 12px !important; background-color: rgb(251, 250, 248); color: rgb(128, 0, 0); font-family: 'Courier New'; line-height: 1.5;">{count++;print $0;} END{print &quot;user count is &quot;, count}</span><span style="white-space: pre-wrap; word-wrap: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 12px !important; background-color: rgb(251, 250, 248); color: rgb(128, 0, 0); font-family: 'Courier New'; line-height: 1.5;">'</span> <span style="white-space: pre-wrap; word-wrap: break-word; font-size: 12px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(251, 250, 248); color: rgb(0, 0, 0); font-family: 'Courier New';">/etc/</span><span style="white-space: pre-wrap; word-wrap: break-word; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 12px !important; background-color: rgb(251, 250, 248); color: rgb(0, 0, 255); font-family: 'Courier New'; line-height: 1.5;">passwd</span></div></div><div><ul><li><span style="font-family: 宋体; line-height: 1.45;">正则表达式</span><br/></li></ul></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;-en-codeblock:true;"><div>‘+’：awk '/smith+ern/' testfile  //一个或多个h</div><div>‘?’：awk '/smith?/' testfile  //零个或1个h</div><div>'|'：awk '/allen | alan/' testfile  //将包含字符串allen或alan的所有记录打印至标准输出</div><div>'()'：awk '/a(ll)?(nn)?e/' testfile  //将具有字符串ae或alle或anne或allnne的所有记录打印至标准输出</div><div>'{m}'：awk '/l{2}/' testfile  //指定如果正好有m个模式的具体值位于字符串中，则字符串匹配</div><div>'{m,n}'：awk '/er{1,2}/' testfile  //指定如果m和n之间个模式的具体值在字符串中，则匹配</div></div><div><br/></div><div><i>sed</i></div><div><hr/></div><div>sed是一种流编辑器，它是文本处理中非常常用的工具</div><div><ul><li><span style="font-family: 宋体; line-height: 1.45;">常用选项：</span><br/></li></ul></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div><font style="font-family: 宋体;">-n 安静模式，只有经过sed特殊处理的那一行才会被列出来</font></div><div><font style="font-family: 宋体;">-e 直接在指令列模式上进行sed动作编辑</font></div><div><font style="font-family: 宋体;">-f filename 直接将sed动作写在一个档案内</font></div><div><font style="font-family: 宋体;">-i 直接修改读取的档案内容</font></div></blockquote><div><ul><li><span style="font-family: 宋体; line-height: 1.45;">常用命令：</span><br/></li></ul></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div><font style="font-family: 宋体;">a 新增，a后面接字串，出现在下一行</font></div><div><font style="font-family: 宋体;">c 取代，c后面接字串，取代n1，n2之间的行</font></div><div><font style="font-family: 宋体;">d 删除，删除某行</font></div><div><font style="font-family: 宋体;">i 插入，i后面接字串，出现在上一行</font></div><div><font style="font-family: 宋体;">p 打印，将选择内容打印</font></div><div><font style="font-family: 宋体;">s 取代， 1,20s/old/new/g</font></div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;-en-codeblock:true;"><div>sed '1d' ab  //<span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">删除某行</span></div><div>sed '$d' ab  //删除最后一行</div><div>sed '1,2d' //删除1-2行</div><div>sed -n '1p' ab //显示第一行</div><div>sed -n '/ruby/p' ab  //查询关键字ruby所在所有行</div><div>sed '1,3a drink tea' ab //第一到第三行后增加字符串“drink tea” </div></div></blockquote><div><br/></div></div></span>
</div></body></html> 